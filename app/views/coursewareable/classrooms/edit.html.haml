= title _('Editing %s' % @classroom.title)
= head_embed javascript_include_tag('editor')
= head_embed stylesheet_link_tag('editor')

= head_embed javascript_include_tag('edit_classroom')
= head_embed stylesheet_link_tag('autocomplete')

= head_embed javascript_include_tag('jquery_ujs')

#classroom
  .eight.columns
    = form_for(@classroom, :url => classroom_path) do |f|
      %p
        = f.label :title, _('Classroom Title')
        = f.text_field :title, :required => true

      .row.collapse
        = f.label :slug, _('Classroom sub-domain')
        .eight.columns
          = f.text_field :slug, :placeholder => _('Leave empty to be generated, minimum length 4, maximum 32.')
        .four.columns
          %span.postfix .coursewa.re

      %p
        = f.label :description, _('Classroom Description')
        = f.text_area :description, :class => 'wysiwyg-minimal', :required => true

      %dl.tabs
        %dd.active
          %a{:href => "#members"}
            = _('Members')
        %dd
          %a{:href => "#collaborators"}
            = _('Collaborators')
      %ul.tabs-content
        %li#membersTab.active
          %p
            = _('Add a new member to this classroom')
          = text_field_tag nil, nil, :class => 'autocomplete_users'
          = hidden_field_tag :members, nil, :class => 'autocomplete_input'

          %h5
            = _('Existing members')

          %ul#members-list.inline-list
            - @classroom.memberships.each do |mem|
              %li
                %div.avatar
                  = gravatar_image_tag(mem.user.email, :alt => mem.user.name)
                %p
                  = mem.user.name
                  = link_to(_('Remove'), membership_path(mem), :method => :delete, :id => "remove-membership-#{mem.id}") unless mem.user.id == current_user.id

        %li#collaboratorsTab
          %p
            = _('Add a new collaborator to this classroom')
          = text_field_tag nil, nil, :class => 'autocomplete_users'
          = hidden_field_tag :collaborators, nil, :class => 'autocomplete_input'
          %h5
            = _('Existing collaborators')

          - if @classroom.collaborators.empty?
            %p
              = _('No collaborators were added.')
          - else
            %ul#collaborators-list.inline-list
              - @classroom.collaborations.each do |colab|
                %li
                  %div.avatar
                    = gravatar_image_tag(colab.user.email, :alt => colab.user.name)
                  %p
                    = colab.user.name
                    = link_to(_('Remove'), collaboration_path(colab), :method => :delete, :id => "remove-collaboration-#{colab.id}")

      %p
        = f.submit _('Update'), :id => 'edit_classroom', :class => 'button primary'

  = render(:partial => 'sidebar')
